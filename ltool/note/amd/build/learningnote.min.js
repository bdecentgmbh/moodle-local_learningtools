define ("ltool_note/learningnote",["jquery","core/modal_factory","core/str","core/fragment","core/modal_events","core/ajax","core/notification"],function(a,b,c,d,e,f,g){function h(a,b){i(a,b)}function i(d,f){a(".ltnoteinfo #ltnote-action").on("click",function(){var g=c.get_string("newnote","local_learningtools");a.when(g).done(function(a){b.create({title:a+j(f),type:b.types.SAVE_CANCEL,body:n(d,f),large:!0}).then(function(a){a.show();a.getRoot().on(e.hidden,function(){a.destroy()});a.getRoot().on(e.save,function(b){b.preventDefault();k(a)});a.getRoot().delegate("#popout-action","click",function(){console.log(f);var b=M.cfg.wwwroot+"/local/learningtools/ltool/note/popout.php?contextid="+f.contextid+"&pagetype="+f.pagetype+"&contextlevel="+f.contextlevel+"&course="+f.course+"&user="+f.user+"&pageurl="+f.pageurl+"&title="+f.title+"&heading="+f.heading;a.hide();window.open(b,"_blank")});a.getRoot().delegate("form","submit",function(b){b.preventDefault();l(a,d,f)})})})})}function j(){return"<div class='popout-block'><button type='submit' id='popout-action' name='popoutsubmit'>Pop out</button><i class='fa fa-window-restore'></i></div>"}function k(a){a.getRoot().find("form").submit()}function l(b,d){var e=b.getRoot().find("form").serialize(),h=c.get_string("successnotemessage","local_learningtools");f.call([{methodname:"ltool_note_save_usernote",args:{contextid:d,formdata:e},done:function done(c){if(c){if(!0!=a(".ltnoteinfo span").hasClass("ticked")){a(".ltnoteinfo span").addClass("ticked")}a(".ltnoteinfo span").empty();a(".ltnoteinfo span").append(c)}b.hide();a.when(h).done(function(a){g.addNotification({message:a,type:"success"})});if(0!=ltools.disappertimenotify){setTimeout(function(){a("span.notifications").empty()},ltools.disappertimenotify)}},fail:m()}])}function m(){}function n(a,b){b.contextid=a;return d.loadFragment("ltool_note","get_note_form",a,b)}return{init:function init(a,b){h(a,b)}}});
//# sourceMappingURL=learningnote.min.js.map
