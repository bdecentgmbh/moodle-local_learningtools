/**
 * Schedule ltool define js.
 * @module   ltool_schedule
 * @copyright 2021, bdecent gmbh bdecent.de
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("ltool_schedule/schedule",["jquery","core/fragment","core/modal_factory","core/str","core/modal_events","core/notification"],(function($,Fragment,ModalFactory,String,ModalEvents,Notification){var LearningToolSchedule=function(params){var self=this,scheduleInfo=document.querySelector(".ltoolschedule-info #ltoolschedule-action");if(scheduleInfo){var schedulehovercolor=scheduleInfo.getAttribute("data-hovercolor"),schedulefontcolor=scheduleInfo.getAttribute("data-fontcolor");schedulehovercolor&&schedulefontcolor&&scheduleInfo.addEventListener("mouseover",(function(){document.querySelector("#ltoolschedule-info p").style.background=schedulehovercolor,document.querySelector("#ltoolschedule-info p").style.color=schedulefontcolor})),scheduleInfo.addEventListener("click",(function(){self.displaySchedulebox(params)}))}};return LearningToolSchedule.prototype.displaySchedulebox=function(params){var self=this,strschedule=String.get_string("schedule","local_learningtools");return ModalFactory.create({title:strschedule,type:ModalFactory.types.SAVE_CANCEL,body:self.getScheduleAction(params),large:!0}).then((function(modal){return modal.getRoot().on(ModalEvents.save,(e=>{e.preventDefault(),$(e.target).find("button[data-action=save]").attr("disabled",!0),modal.getRoot().find("form").submit()})),modal.getRoot().on("submit","form",(e=>{if(e.preventDefault(),document.querySelectorAll("#ltoolschedule-editorbox input[name='schedulename']")[0].value){self.submitFormData(params.contextid);var successinfo=String.get_string("successtoolschedule","local_learningtools");$.when(successinfo).done((function(localizedEditString){Notification.addNotification({message:localizedEditString,type:"success"})})),0!=ltools.disappertimenotify&&setTimeout((function(){document.querySelector("span.notifications").innerHTML=""}),ltools.disappertimenotify)}modal.hide()})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show(),modal})).fail(Notification.exception)},LearningToolSchedule.prototype.submitFormData=function(contextid){var modalform=document.querySelectorAll("#ltoolschedule-editorbox form")[0],formData=new URLSearchParams(new FormData(modalform)).toString();return Fragment.loadFragment("ltool_schedule","set_calendar_event",contextid,{formdata:formData}),!0},LearningToolSchedule.prototype.getScheduleAction=function(params){return Fragment.loadFragment("ltool_schedule","get_schedule_form",params.contextid,params)},{init:function(params){return new LearningToolSchedule(params)}}}));

//# sourceMappingURL=schedule.min.js.map