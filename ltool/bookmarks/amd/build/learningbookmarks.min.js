/**
 * Bookmarks ltool define js.
 * @module   ltool_bookmarks
 * @category  Classes - autoloading
 * @copyright 2021, bdecent gmbh bdecent.de
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("ltool_bookmarks/learningbookmarks",["core/str","core/ajax","core/notification","jquery"],(function(String,Ajax,notification,$){function learningToolBookmarksAction(contextid,params){var bookmarkmarked=document.getElementById("bookmarks-marked");bookmarkmarked&&(pagebookmarks?bookmarkmarked.classList.add("marked"):bookmarkmarked.classList.remove("marked"));var bookmarksform=document.getElementById("ltbookmarks-action");if(bookmarksform){bookmarksform.addEventListener("click",(function(e){e.preventDefault(),submitFormdata(contextid,params)}));var bookmarkshovercolor=bookmarksform.getAttribute("data-hovercolor"),bookmarksfontcolor=bookmarksform.getAttribute("data-fontcolor");bookmarkshovercolor&&bookmarksfontcolor&&bookmarksform.addEventListener("mouseover",(function(){document.querySelector("#ltbookmarksinfo p").style.background=bookmarkshovercolor,document.querySelector("#ltbookmarksinfo p").style.color=bookmarksfontcolor}))}$(document).on("click",".content-designer-learningtool-bookmark",(function(e){e.preventDefault();var button=$(this),itemType=button.data("itemtype"),itemId=button.data("itemid"),userid=button.data("userid"),sesskey=button.data("sesskey"),course=button.data("courseid"),coursemodule=button.data("coursemodule"),contextlevel=button.data("contextlevel"),pagetype=button.data("pagetype"),pageurl=button.data("pageurl");submitFormdata(M.cfg.contextid,{pagetitle:document.title,pageurl:pageurl,pageid:0,itemtype:itemType,itemid:itemId,user:userid,sesskey:sesskey,course:course,coursemodule:coursemodule,contextlevel:contextlevel,pagetype:pagetype},button)}));var bookmarkssorttype=document.getElementById("bookmarkssorttype");bookmarkssorttype&&bookmarkssorttype.addEventListener("click",(function(){!function(sorttype){var pageurl=window.location.href,para="";pageurl=function(url,parameter){var urlparts=url.split("?");if(urlparts.length>=2){for(var prefix=encodeURIComponent(parameter)+"=",pars=urlparts[1].split(/[&;]/g),i=pars.length;i-- >0;)-1!==pars[i].lastIndexOf(prefix,0)&&pars.splice(i,1);return url=urlparts[0]+(pars.length>0?"?"+pars.join("&"):"")}return url}(pageurl,"sorttype"),"asc"==sorttype?sorttype="desc":"desc"==sorttype&&(sorttype="asc");para=pageurl.indexOf("?")>-1?"&":"?";pageurl=pageurl+para+"sorttype="+sorttype,window.open(pageurl,"_self")}(this.getAttribute("data-type"))}))}function submitFormdata(contextid,formData){let button=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;""==formData.pagetitle&&(formData.pagetitle=document.querySelector("title").innerHTML);var Formdata=JSON.stringify(formData);Ajax.call([{methodname:"ltool_bookmarks_save_userbookmarks",args:{contextid:contextid,formdata:Formdata},done:function(response){notification.addNotification({message:response.bookmarksmsg,type:response.notificationtype});let bookmarkmarked=document.getElementById("bookmarks-marked");response.bookmarksstatus?button?require(["mod_contentdesigner/elements"],(function(Elements){formData.itemid&&(Elements.removeWarning(),Elements.refreshContent())})):bookmarkmarked.classList.add("marked"):button?require(["mod_contentdesigner/elements"],(function(Elements){formData.itemid&&(Elements.removeWarning(),Elements.refreshContent())})):bookmarkmarked.classList.remove("marked"),0!=ltools.disappertimenotify&&setTimeout((function(){document.querySelector("span.notifications").innerHTML=""}),ltools.disappertimenotify)},fail:function(error){notification.exception(error)}}])}return{init:function(contextid,params){learningToolBookmarksAction(contextid,params)}}}));

//# sourceMappingURL=learningbookmarks.min.js.map