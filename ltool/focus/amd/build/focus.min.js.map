{"version":3,"sources":["../src/focus.js"],"names":["define","$","Ajax","LearningToolFocus","focusMode","self","focusInfo","document","querySelector","disableButton","classList","contains","remove","addEventListener","focusBlock","focusModeAction","removeFocusMode","add","addFocusMode","focushovercolor","getAttribute","focusfontcolor","style","background","color","prototype","element","focusCssUrl","focusCssLink","querySelectorAll","setAttribute","loadEnableFocusmode","loadDisableFocusmode","body","status","call","methodname","args","done","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Focus ltool define js.\n * @module   ltool_focus\n * @copyright 2021, bdecent gmbh bdecent.de\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'core/ajax'],\n function($, Ajax) {\n\n    /**\n     * Controls focus tool action.\n     * @param {int} focusMode\n     */\n    var LearningToolFocus = function(focusMode) {\n        var self = this;\n        var focusInfo = document.querySelector(\".ltoolfocus-info #ltoolfocus-action\");\n        if (focusMode) {\n            if (self.disableButton) {\n                if (self.disableButton.classList.contains('d-none')) {\n                    self.disableButton.classList.remove('d-none');\n                }\n            }\n        }\n\n        if (focusInfo) {\n            focusInfo.addEventListener(\"click\", function() {\n                var focusBlock = document.querySelector('.ltoolfocus-info');\n                if (focusBlock) {\n                    if (focusBlock.classList.contains('enable')) {\n                        focusBlock.classList.remove('enable');\n                        self.focusModeAction(0);\n                        self.removeFocusMode();\n                    } else {\n                        focusBlock.classList.add('enable');\n                        self.focusModeAction(1);\n                        self.addFocusMode(focusBlock);\n                    }\n                }\n            });\n\n            // Hover color.\n            var focushovercolor = focusInfo.getAttribute(\"data-hovercolor\");\n            var focusfontcolor = focusInfo.getAttribute(\"data-fontcolor\");\n            if (focushovercolor && focusfontcolor) {\n                focusInfo.addEventListener(\"mouseover\", function() {\n                    document.querySelector('#ltoolfocus-action p').style.background = focushovercolor;\n                    document.querySelector('#ltoolfocus-action p').style.color = focusfontcolor;\n                });\n            }\n        }\n\n        if (self.disableButton) {\n            self.disableButton.addEventListener(\"click\", function() {\n                self.focusModeAction(0);\n                self.removeFocusMode();\n            });\n        }\n    };\n\n    LearningToolFocus.prototype.disableButton = document.querySelector('#page-wrapper #disable-focusmode');\n\n    LearningToolFocus.prototype.addFocusMode = function(element) {\n        var self = this;\n        var focusCssUrl = element.getAttribute('data-focuscssurl');\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\n        if (focusCssLink) {\n            focusCssLink.setAttribute('href', focusCssUrl);\n        }\n        self.loadEnableFocusmode();\n    };\n\n    LearningToolFocus.prototype.removeFocusMode = function() {\n        var self = this;\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\n        if (focusCssLink) {\n            focusCssLink.setAttribute('href', \"\");\n        }\n\n        var focusBlock = document.querySelector('.ltoolfocus-info');\n        if (focusBlock.classList.contains('enable')) {\n            focusBlock.classList.remove('enable');\n        }\n        self.loadDisableFocusmode();\n    };\n\n    LearningToolFocus.prototype.loadDisableFocusmode = function() {\n        var self = this;\n        if (self.disableButton) {\n            if (!self.disableButton.classList.contains('d-none')) {\n                self.disableButton.classList.add('d-none');\n            }\n        }\n    };\n\n    LearningToolFocus.prototype.loadEnableFocusmode = function() {\n        var self = this;\n        // Implemented the focus disable button.\n        var body = document.querySelector(\"body\");\n        if (body) {\n            if (!body.classList.contains('drawer-open-left')) {\n                body.classList.remove('drawer-open-left');\n            }\n        }\n        if (self.disableButton) {\n            self.disableButton.classList.remove('d-none');\n        }\n    };\n\n    LearningToolFocus.prototype.focusModeAction = function(status) {\n        Ajax.call([{\n            methodname: 'ltool_focus_save_userfocusmode',\n            args: {status: status},\n            done: function() {\n                return true;\n            }\n        }]);\n    };\n\n    return {\n        init: function(focusMode) {\n            return new LearningToolFocus(focusMode);\n        }\n    };\n\n });"],"file":"focus.min.js"}