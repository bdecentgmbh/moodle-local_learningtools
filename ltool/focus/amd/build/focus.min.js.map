{"version":3,"sources":["../src/focus.js"],"names":["define","$","Ajax","LearningToolFocus","focusMode","self","focusBlock","document","querySelector","focusInfo","addFocusMode","disableButton","classList","contains","remove","addEventListener","focusModeAction","removeFocusMode","add","focushovercolor","getAttribute","focusfontcolor","style","background","color","prototype","element","focusCssUrl","focusCssLink","querySelectorAll","setAttribute","loadEnableFocusmode","loadDisableFocusmode","body","status","call","methodname","args","done","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Focus ltool define js.\n * @module   ltool_focus\n * @copyright 2021, bdecent gmbh bdecent.de\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'core/ajax'],\n function($, Ajax) {\n\n    /**\n     * Controls focus tool action.\n     * @param {int} focusMode\n     */\n    var LearningToolFocus = function(focusMode) {\n        var self = this;\n        var focusBlock = document.querySelector('.ltoolfocus-info');\n        var focusInfo = document.querySelector(\".ltoolfocus-info #ltoolfocus-action\");\n        if (focusMode) {\n            self.addFocusMode(focusBlock);\n            if (self.disableButton) {\n                if (self.disableButton.classList.contains('d-none')) {\n                    self.disableButton.classList.remove('d-none');\n                }\n            }\n        }\n\n        if (focusInfo) {\n            focusInfo.addEventListener(\"click\", function() {\n                if (focusBlock) {\n                    if (focusBlock.classList.contains('enable')) {\n                        focusBlock.classList.remove('enable');\n                        self.focusModeAction(0);\n                        self.removeFocusMode();\n                    } else {\n                        focusBlock.classList.add('enable');\n                        self.focusModeAction(1);\n                        self.addFocusMode(focusBlock);\n                    }\n                }\n            });\n\n            // Hover color.\n            var focushovercolor = focusInfo.getAttribute(\"data-hovercolor\");\n            var focusfontcolor = focusInfo.getAttribute(\"data-fontcolor\");\n            if (focushovercolor && focusfontcolor) {\n                focusInfo.addEventListener(\"mouseover\", function() {\n                    document.querySelector('#ltoolfocus-info p').style.background = focushovercolor;\n                    document.querySelector('#ltoolfocus-info p').style.color = focusfontcolor;\n                });\n            }\n        }\n\n        if (self.disableButton) {\n            self.disableButton.addEventListener(\"click\", function() {\n                self.focusModeAction(0);\n                self.removeFocusMode();\n            });\n        }\n    };\n\n    LearningToolFocus.prototype.disableButton = document.querySelector('#page-wrapper #disable-focusmode');\n\n    LearningToolFocus.prototype.addFocusMode = function(element) {\n        var self = this;\n        var focusCssUrl = element.getAttribute('data-focuscssurl');\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\n        if (focusCssLink) {\n            focusCssLink.setAttribute('href', focusCssUrl);\n        }\n        self.loadEnableFocusmode();\n    };\n\n    LearningToolFocus.prototype.removeFocusMode = function() {\n        var self = this;\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\n        if (focusCssLink) {\n            focusCssLink.setAttribute('href', \"\");\n        }\n\n        var focusBlock = document.querySelector('.ltoolfocus-info');\n        if (focusBlock.classList.contains('enable')) {\n            focusBlock.classList.remove('enable');\n        }\n        self.loadDisableFocusmode();\n    };\n\n    LearningToolFocus.prototype.loadDisableFocusmode = function() {\n        var self = this;\n        if (self.disableButton) {\n            if (!self.disableButton.classList.contains('d-none')) {\n                self.disableButton.classList.add('d-none');\n            }\n        }\n    };\n\n    LearningToolFocus.prototype.loadEnableFocusmode = function() {\n        var self = this;\n        // Implemented the focus disable button.\n        var body = document.querySelector(\"body\");\n        if (body) {\n            if (!body.classList.contains('drawer-open-left')) {\n                body.classList.remove('drawer-open-left');\n            }\n        }\n        if (self.disableButton) {\n            self.disableButton.classList.remove('d-none');\n        }\n    };\n\n    LearningToolFocus.prototype.focusModeAction = function(status) {\n        Ajax.call([{\n            methodname: 'ltool_focus_save_userfocusmode',\n            args: {status: status},\n            done: function() {\n                return true;\n            }\n        }]);\n    };\n\n    return {\n        init: function(focusMode) {\n            return new LearningToolFocus(focusMode);\n        }\n    };\n\n });"],"file":"focus.min.js"}