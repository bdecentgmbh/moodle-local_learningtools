{"version":3,"file":"focus.min.js","sources":["../src/focus.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Focus ltool define js.\r\n * @module   ltool_focus\r\n * @copyright 2021, bdecent gmbh bdecent.de\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n define(['jquery', 'core/ajax'],\r\n function($, Ajax) {\r\n\r\n    /**\r\n     * Controls focus tool action.\r\n     * @param {int} focusMode\r\n     */\r\n    var LearningToolFocus = function(focusMode) {\r\n        var self = this;\r\n        var focusBlock = document.querySelector('.ltoolfocus-info');\r\n        var focusInfo = document.querySelector(\".ltoolfocus-info #ltoolfocus-action\");\r\n        if (focusMode) {\r\n            self.addFocusMode(focusBlock);\r\n            if (self.disableButton) {\r\n                if (self.disableButton.classList.contains('d-none')) {\r\n                    self.disableButton.classList.remove('d-none');\r\n                }\r\n            }\r\n        }\r\n\r\n        if (focusInfo) {\r\n            focusInfo.addEventListener(\"click\", function() {\r\n                if (focusBlock) {\r\n                    if (focusBlock.classList.contains('enable')) {\r\n                        focusBlock.classList.remove('enable');\r\n                        self.focusModeAction(0);\r\n                        self.removeFocusMode();\r\n                    } else {\r\n                        focusBlock.classList.add('enable');\r\n                        self.focusModeAction(1);\r\n                        self.addFocusMode(focusBlock);\r\n                    }\r\n                }\r\n            });\r\n\r\n            // Hover color.\r\n            var focushovercolor = focusInfo.getAttribute(\"data-hovercolor\");\r\n            var focusfontcolor = focusInfo.getAttribute(\"data-fontcolor\");\r\n            if (focushovercolor && focusfontcolor) {\r\n                focusInfo.addEventListener(\"mouseover\", function() {\r\n                    document.querySelector('#ltoolfocus-info p').style.background = focushovercolor;\r\n                    document.querySelector('#ltoolfocus-info p').style.color = focusfontcolor;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (self.disableButton) {\r\n            self.disableButton.addEventListener(\"click\", function() {\r\n                self.focusModeAction(0);\r\n                self.removeFocusMode();\r\n            });\r\n        }\r\n    };\r\n\r\n    LearningToolFocus.prototype.disableButton = document.querySelector('#page-wrapper #disable-focusmode');\r\n\r\n    LearningToolFocus.prototype.addFocusMode = function(element) {\r\n        var self = this;\r\n        var focusCssUrl = element.getAttribute('data-focuscssurl');\r\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\r\n        if (focusCssLink) {\r\n            focusCssLink.setAttribute('href', focusCssUrl);\r\n        }\r\n        self.loadEnableFocusmode();\r\n    };\r\n\r\n    LearningToolFocus.prototype.removeFocusMode = function() {\r\n        var self = this;\r\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\r\n        if (focusCssLink) {\r\n            focusCssLink.setAttribute('href', \"\");\r\n        }\r\n\r\n        var focusBlock = document.querySelector('.ltoolfocus-info');\r\n        if (focusBlock.classList.contains('enable')) {\r\n            focusBlock.classList.remove('enable');\r\n        }\r\n        self.loadDisableFocusmode();\r\n    };\r\n\r\n    LearningToolFocus.prototype.loadDisableFocusmode = function() {\r\n        var self = this;\r\n        if (self.disableButton) {\r\n            if (!self.disableButton.classList.contains('d-none')) {\r\n                self.disableButton.classList.add('d-none');\r\n            }\r\n        }\r\n    };\r\n\r\n    LearningToolFocus.prototype.loadEnableFocusmode = function() {\r\n        var self = this;\r\n        // Implemented the focus disable button.\r\n        var body = document.querySelector(\"body\");\r\n        if (body) {\r\n            if (!body.classList.contains('drawer-open-left')) {\r\n                body.classList.remove('drawer-open-left');\r\n            }\r\n        }\r\n        if (self.disableButton) {\r\n            self.disableButton.classList.remove('d-none');\r\n        }\r\n    };\r\n\r\n    LearningToolFocus.prototype.focusModeAction = function(status) {\r\n        Ajax.call([{\r\n            methodname: 'ltool_focus_save_userfocusmode',\r\n            args: {status: status},\r\n            done: function() {\r\n                return true;\r\n            }\r\n        }]);\r\n    };\r\n\r\n    return {\r\n        init: function(focusMode) {\r\n            return new LearningToolFocus(focusMode);\r\n        }\r\n    };\r\n\r\n });"],"names":["define","$","Ajax","LearningToolFocus","focusMode","self","this","focusBlock","document","querySelector","focusInfo","addFocusMode","disableButton","classList","contains","remove","addEventListener","focusModeAction","removeFocusMode","add","focushovercolor","getAttribute","focusfontcolor","style","background","color","prototype","element","focusCssUrl","focusCssLink","querySelectorAll","setAttribute","loadEnableFocusmode","loadDisableFocusmode","body","status","call","methodname","args","done","init"],"mappings":";;;;;;AAsBCA,2BAAO,CAAC,SAAU,cAClB,SAASC,EAAGC,UAMLC,kBAAoB,SAASC,eACzBC,KAAOC,KACPC,WAAaC,SAASC,cAAc,oBACpCC,UAAYF,SAASC,cAAc,0CACnCL,YACAC,KAAKM,aAAaJ,YACdF,KAAKO,eACDP,KAAKO,cAAcC,UAAUC,SAAS,WACtCT,KAAKO,cAAcC,UAAUE,OAAO,WAK5CL,UAAW,CACXA,UAAUM,iBAAiB,SAAS,WAC5BT,aACIA,WAAWM,UAAUC,SAAS,WAC9BP,WAAWM,UAAUE,OAAO,UAC5BV,KAAKY,gBAAgB,GACrBZ,KAAKa,oBAELX,WAAWM,UAAUM,IAAI,UACzBd,KAAKY,gBAAgB,GACrBZ,KAAKM,aAAaJ,qBAM1Ba,gBAAkBV,UAAUW,aAAa,mBACzCC,eAAiBZ,UAAUW,aAAa,kBACxCD,iBAAmBE,gBACnBZ,UAAUM,iBAAiB,aAAa,WACpCR,SAASC,cAAc,sBAAsBc,MAAMC,WAAaJ,gBAChEZ,SAASC,cAAc,sBAAsBc,MAAME,MAAQH,kBAKnEjB,KAAKO,eACLP,KAAKO,cAAcI,iBAAiB,SAAS,WACzCX,KAAKY,gBAAgB,GACrBZ,KAAKa,6BAKjBf,kBAAkBuB,UAAUd,cAAgBJ,SAASC,cAAc,oCAEnEN,kBAAkBuB,UAAUf,aAAe,SAASgB,aAE5CC,YAAcD,QAAQN,aAAa,oBACnCQ,aAAerB,SAASsB,iBAAiB,oCAAoC,GAC7ED,cACAA,aAAaE,aAAa,OAAQH,aAJ3BtB,KAMN0B,uBAGT7B,kBAAkBuB,UAAUR,gBAAkB,eAEtCW,aAAerB,SAASsB,iBAAiB,oCAAoC,GAC7ED,cACAA,aAAaE,aAAa,OAAQ,QAGlCxB,WAAaC,SAASC,cAAc,oBACpCF,WAAWM,UAAUC,SAAS,WAC9BP,WAAWM,UAAUE,OAAO,UARrBT,KAUN2B,wBAGT9B,kBAAkBuB,UAAUO,qBAAuB,WACpC3B,KACFM,gBADEN,KAEGM,cAAcC,UAAUC,SAAS,WAFpCR,KAGEM,cAAcC,UAAUM,IAAI,YAK7ChB,kBAAkBuB,UAAUM,oBAAsB,eAG1CE,KAAO1B,SAASC,cAAc,QAC9ByB,OACKA,KAAKrB,UAAUC,SAAS,qBACzBoB,KAAKrB,UAAUE,OAAO,qBALnBT,KAQFM,eAREN,KASFM,cAAcC,UAAUE,OAAO,WAI5CZ,kBAAkBuB,UAAUT,gBAAkB,SAASkB,QACnDjC,KAAKkC,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAM,CAACH,OAAQA,QACfI,KAAM,kBACK,OAKZ,CACHC,KAAM,SAASpC,kBACJ,IAAID,kBAAkBC"}